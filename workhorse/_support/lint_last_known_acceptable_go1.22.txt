cmd/gitlab-resize-image/main.go:1:1: package-comments: should have a package comment (revive)
cmd/gitlab-resize-image/png/reader.go:1:1: package-comments: should have a package comment (revive)
cmd/gitlab-resize-image/png/reader.go:26:1: exported: exported function NewReader should have comment or be unexported (revive)
cmd/gitlab-resize-image/png/reader.go:78:17: var-declaration: should omit type []byte from declaration of var magicBytes; it will be inferred from the right-hand side (revive)
cmd/gitlab-workhorse/config_test.go:191: cmd/gitlab-workhorse/config_test.go:191: Line contains TODO/BUG/FIXME/NOTE/OPTIMIZE/HACK: "TODO this is meant to be 50*time.Second ..." (godox)
cmd/gitlab-workhorse/listener.go:26:16: G402: TLS MinVersion too low. (gosec)
cmd/gitlab-workhorse/main.go:9:2: G108: Profiling endpoint is automatically exposed on /debug/pprof (gosec)
cmd/gitlab-workhorse/main.go:73: Function 'buildConfig' has too many statements (63 > 40) (funlen)
cmd/gitlab-workhorse/main.go:79:14: Error return value of `fmt.Fprintf` is not checked (errcheck)
cmd/gitlab-workhorse/main.go:80:14: Error return value of `fmt.Fprintf` is not checked (errcheck)
cmd/gitlab-workhorse/main.go:120:15: Error return value of `fmt.Fprintln` is not checked (errcheck)
cmd/gitlab-workhorse/main.go:168: Function 'run' has too many statements (61 > 40) (funlen)
cmd/gitlab-workhorse/main.go:173:20: Error return value of `closer.Close` is not checked (errcheck)
cmd/gitlab-workhorse/main.go:181:6: shadow: declaration of "err" shadows declaration at line 169 (govet)
cmd/gitlab-workhorse/main.go:193:6: shadow: declaration of "err" shadows declaration at line 169 (govet)
cmd/gitlab-workhorse/main.go:198:30: G114: Use of net/http serve function that has no support for setting timeouts (gosec)
cmd/gitlab-workhorse/main.go:203:6: shadow: declaration of "err" shadows declaration at line 169 (govet)
cmd/gitlab-workhorse/main.go:212:6: shadow: declaration of "err" shadows declaration at line 169 (govet)
cmd/gitlab-workhorse/main.go:233:5: shadow: declaration of "err" shadows declaration at line 169 (govet)
cmd/gitlab-workhorse/main.go:241:26: Error return value of `accessCloser.Close` is not checked (errcheck)
cmd/gitlab-workhorse/main.go:265:10: G112: Potential Slowloris Attack because ReadHeaderTimeout is not configured in the http.Server (gosec)
cmd/gitlab-workhorse/main_test.go:60:2: exitAfterDefer: os.Exit will exit, and `defer gitaly.CloseConnections()` will not run (gocritic)
cmd/gitlab-workhorse/proxy_test.go:55:9: shadow: declaration of "err" shadows declaration at line 36 (govet)
cmd/gitlab-workhorse/proxy_test.go:77:6: var-naming: var tsUrl should be tsURL (revive)
cmd/gitlab-workhorse/proxy_test.go:87:6: shadow: declaration of "err" shadows declaration at line 78 (govet)
cmd/gitlab-workhorse/raven.go:17:14: Error return value of `raven.SetDSN` is not checked (errcheck)
cmd/gitlab-workhorse/upload_test.go:372:4: require-error: for error assertions use require (testifylint)
cmd/gitlab-workhorse/upload_test.go:377:4: require-error: for error assertions use require (testifylint)
cmd/gitlab-zip-cat/main.go:1:1: package-comments: should have a package comment (revive)
cmd/gitlab-zip-cat/main.go:19:5: exported: exported var Version should have comment or be unexported (revive)
cmd/gitlab-zip-cat/main.go:66:20: Error return value of `reader.Close` is not checked (errcheck)
cmd/gitlab-zip-cat/main.go:72:15: G110: Potential DoS vulnerability via decompression bomb (gosec)
cmd/gitlab-zip-cat/main.go:93:9: superfluous-else: if block ends with call to os.Exit function, so drop this else and outdent its block (revive)
cmd/gitlab-zip-metadata/limit/reader.go:1:1: package-comments: should have a package comment (revive)
cmd/gitlab-zip-metadata/limit/reader.go:9:5: exported: exported var ErrLimitExceeded should have comment or be unexported (revive)
cmd/gitlab-zip-metadata/limit/reader.go:20:1: exported: exported method LimitedReaderAt.ReadAt should have comment or be unexported (revive)
cmd/gitlab-zip-metadata/limit/reader.go:37:1: exported: exported function NewLimitedReaderAt should have comment or be unexported (revive)
cmd/gitlab-zip-metadata/main.go:1:1: package-comments: should have a package comment (revive)
cmd/gitlab-zip-metadata/main.go:17:5: exported: exported var Version should have comment or be unexported (revive)
cmd/gitlab-zip-metadata/main.go:66:9: superfluous-else: if block ends with call to os.Exit function, so drop this else and outdent its block (revive)
internal/api/api.go:146:2: var-naming: don't use ALL_CAPS in Go names; use CamelCase (revive)
internal/api/api.go:149:2: var-naming: don't use ALL_CAPS in Go names; use CamelCase (revive)
internal/api/api.go:153:2: var-naming: don't use ALL_CAPS in Go names; use CamelCase (revive)
internal/api/block_test.go:61:34: response body must be closed (bodyclose)
internal/api/channel_settings.go:57:28: G402: TLS MinVersion too low. (gosec)
internal/api/channel_settings_test.go:125:22: SA1019: dialer.TLSClientConfig.RootCAs.Subjects has been deprecated since Go 1.18: if s was returned by [SystemCertPool], Subjects will not include the system roots. (staticcheck)
internal/builds/register.go:120: Function 'RegisterHandler' is too long (66 > 60) (funlen)
internal/channel/channel.go:128:31: response body must be closed (bodyclose)
internal/config/config.go:1:1: package-comments: should have a package comment (revive)
internal/config/config.go:27:7: exported: exported const Megabyte should have comment or be unexported (revive)
internal/config/config.go:38:6: exported: exported type TomlURL should have comment or be unexported (revive)
internal/config/config.go:42:1: exported: exported method TomlURL.UnmarshalText should have comment or be unexported (revive)
internal/config/config.go:48:1: exported: exported method TomlURL.MarshalText should have comment or be unexported (revive)
internal/config/config.go:52:6: exported: exported type TomlDuration should have comment or be unexported (revive)
internal/config/config.go:56:1: exported: exported method TomlDuration.UnmarshalText should have comment or be unexported (revive)
internal/config/config.go:62:1: exported: exported method TomlDuration.MarshalText should have comment or be unexported (revive)
internal/config/config.go:66:6: exported: exported type ObjectStorageCredentials should have comment or be unexported (revive)
internal/config/config.go:74:6: exported: exported type ObjectStorageConfig should have comment or be unexported (revive)
internal/config/config.go:78:6: exported: exported type S3Credentials should have comment or be unexported (revive)
internal/config/config.go:84:6: exported: exported type S3Config should have comment or be unexported (revive)
internal/config/config.go:94:6: exported: exported type GoCloudConfig should have comment or be unexported (revive)
internal/config/config.go:98:6: exported: exported type AzureCredentials should have comment or be unexported (revive)
internal/config/config.go:103:6: exported: exported type GoogleCredentials should have comment or be unexported (revive)
internal/config/config.go:109:6: exported: exported type RedisConfig should have comment or be unexported (revive)
internal/config/config.go:126:6: exported: exported type ImageResizerConfig should have comment or be unexported (revive)
internal/config/config.go:132:6: exported: exported type MetadataConfig should have comment or be unexported (revive)
internal/config/config.go:136:6: exported: exported type TLSConfig should have comment or be unexported (revive)
internal/config/config.go:144:6: exported: exported type ListenerConfig should have comment or be unexported (revive)
internal/config/config.go:147:2: var-naming: struct field Tls should be TLS (revive)
internal/config/config.go:150:6: exported: exported type Config should have comment or be unexported (revive)
internal/config/config.go:179:5: exported: exported var DefaultImageResizerConfig should have comment or be unexported (revive)
internal/config/config.go:184:5: exported: exported var DefaultMetadataConfig should have comment or be unexported (revive)
internal/config/config.go:188:1: exported: exported function NewDefaultConfig should have comment or be unexported (revive)
internal/config/config.go:195:1: exported: exported function LoadConfigFromFile should have comment or be unexported (revive)
internal/config/config.go:209:1: exported: exported function LoadConfig should have comment or be unexported (revive)
internal/config/config.go:218:18: G204: Subprocess launched with variable (gosec)
internal/config/config.go:236:1: exported: exported method Config.RegisterGoCloudURLOpeners should have comment or be unexported (revive)
internal/config/config.go:259:70: (*AzureCredentials).getURLOpener - result 1 (error) is always nil (unparam)
internal/config/config.go:302:8: G101: Potential hardcoded credentials (gosec)
internal/dependencyproxy/dependencyproxy.go:88: Function 'Inject' is too long (70 > 60) (funlen)
internal/dependencyproxy/dependencyproxy.go:126:32: `cancelled` is a misspelling of `canceled` (misspell)
internal/dependencyproxy/dependencyproxy_test.go:424:4: go-require: do not use assert.FailNow in http handlers (testifylint)
internal/dependencyproxy/dependencyproxy_test.go:451:33: `artifically` is a misspelling of `artificially` (misspell)
internal/dependencyproxy/dependencyproxy_test.go:476: internal/dependencyproxy/dependencyproxy_test.go:476: Line contains TODO/BUG/FIXME/NOTE/OPTIMIZE/HACK: "note that the timeout duration here is s..." (godox)
internal/git/archive.go:35:2: var-naming: struct field CommitId should be CommitID (revive)
internal/git/archive.go:43:2: exported: exported var SendArchive should have comment or be unexported (revive)
internal/git/archive.go:53: Function 'Inject' has too many statements (47 > 40) (funlen)
internal/git/archive.go:73:29: Error return value of `cachedArchive.Close` is not checked (errcheck)
internal/git/archive.go:99:23: Error return value of `tempFile.Close` is not checked (errcheck)
internal/git/archive.go:100:18: Error return value of `os.Remove` is not checked (errcheck)
internal/git/blob.go:21:5: exported: exported var SendBlob should have comment or be unexported (revive)
internal/git/diff.go:1: 1-47 lines are duplicate of `internal/git/format-patch.go:1-48` (dupl)
internal/git/diff.go:22:5: exported: exported var SendDiff should have comment or be unexported (revive)
internal/git/error.go:36:4: singleCaseSwitch: should rewrite switch statement to if statement (gocritic)
internal/git/error_test.go:28: File is not `gofmt`-ed with `-s` (gofmt)
internal/git/error_test.go:66:2: unnecessary trailing newline (whitespace)
internal/git/format-patch.go:1: 1-48 lines are duplicate of `internal/git/diff.go:1-47` (dupl)
internal/git/format-patch.go:22:5: exported: exported var SendPatch should have comment or be unexported (revive)
internal/git/git-http.go:21:2: exported: comment on exported const GitConfigShowAllRefs should be of the form "GitConfigShowAllRefs ..." (revive)
internal/git/git-http.go:26:1: exported: exported function ReceivePack should have comment or be unexported (revive)
internal/git/git-http.go:30:1: exported: exported function UploadPack should have comment or be unexported (revive)
internal/git/info-refs.go:20:1: exported: exported function GetInfoRefsHandler should have comment or be unexported (revive)
internal/git/io.go:141:22: Error return value of `tempfile.Close` is not checked (errcheck)
internal/git/io.go:173:17: Error return value of `tempfile.Close` is not checked (errcheck)
internal/git/io_test.go:89:14: string `test data` has 3 occurrences, make it a constant (goconst)
internal/git/receive-pack.go:21:16: Error return value of `cw.Flush` is not checked (errcheck)
internal/git/responsewriter.go:41:6: exported: exported type HTTPResponseWriter should have comment or be unexported (revive)
internal/git/responsewriter.go:45:1: exported: exported function NewHTTPResponseWriter should have comment or be unexported (revive)
internal/git/responsewriter.go:52:1: exported: exported method HTTPResponseWriter.Log should have comment or be unexported (revive)
internal/git/snapshot.go:27:2: exported: exported var SendSnapshot should have comment or be unexported (revive)
internal/git/upload-pack.go:37:16: Error return value of `cw.Flush` is not checked (errcheck)
internal/git/upload-pack_test.go:71:2: error-is-as: use require.ErrorIs (testifylint)
internal/gitaly/blob.go:1:1: package-comments: should have a package comment (revive)
internal/gitaly/blob.go:14:6: exported: exported type BlobClient should have comment or be unexported (revive)
internal/gitaly/blob.go:18:1: exported: exported method BlobClient.SendBlob should have comment or be unexported (revive)
internal/gitaly/diff.go:1:1: ST1000: at least one file in a package should have a package comment (stylecheck)
internal/gitaly/diff.go:13:6: exported: exported type DiffClient should have comment or be unexported (revive)
internal/gitaly/diff.go:17: 17-35 lines are duplicate of `internal/gitaly/diff.go:37-55` (dupl)
internal/gitaly/diff.go:37: 37-55 lines are duplicate of `internal/gitaly/diff.go:17-35` (dupl)
internal/gitaly/gitaly.go:1:1: ST1000: at least one file in a package should have a package comment (stylecheck)
internal/gitaly/gitaly.go:63:1: exported: exported function InitializeSidechannelRegistry should have comment or be unexported (revive)
internal/gitaly/gitaly.go:85:1: exported: exported function NewSmartHTTPClient should have comment or be unexported (revive)
internal/gitaly/gitaly.go:98:1: exported: exported function NewBlobClient should have comment or be unexported (revive)
internal/gitaly/gitaly.go:107:1: exported: exported function NewRepositoryClient should have comment or be unexported (revive)
internal/gitaly/gitaly.go:116:1: exported: exported function NewDiffClient should have comment or be unexported (revive)
internal/gitaly/gitaly.go:155:5: shadow: declaration of "conn" shadows declaration at line 145 (govet)
internal/gitaly/gitaly.go:169:1: exported: exported function CloseConnections should have comment or be unexported (revive)
internal/gitaly/gitaly.go:174:13: Error return value of `conn.Close` is not checked (errcheck)
internal/gitaly/gitaly.go:179:14: appendAssign: append result not assigned to the same slice (gocritic)
internal/gitaly/gitaly.go:219:1: exported: exported function UnmarshalJSON should have comment or be unexported (revive)
internal/gitaly/repository.go:1:1: ST1000: at least one file in a package should have a package comment (stylecheck)
internal/gitaly/smarthttp.go:1:1: ST1000: at least one file in a package should have a package comment (stylecheck)
internal/gitaly/smarthttp.go:13:6: exported: exported type SmartHTTPClient should have comment or be unexported (revive)
internal/gitaly/smarthttp.go:18:1: exported: exported method SmartHTTPClient.InfoRefsResponseReader should have comment or be unexported (revive)
internal/gitaly/smarthttp.go:48:1: exported: exported method SmartHTTPClient.ReceivePack should have comment or be unexported (revive)
internal/gitaly/smarthttp.go:84:19: Error return value of `stream.CloseSend` is not checked (errcheck)
internal/gitaly/smarthttp.go:97:1: exported: exported method SmartHTTPClient.UploadPack should have comment or be unexported (revive)
internal/gitaly/smarthttp.go:113:20: Error return value of `waiter.Close` is not checked (errcheck)
internal/headers/headers.go:10: internal/headers/headers.go:10: Line contains TODO/BUG/FIXME/NOTE/OPTIMIZE/HACK: "Fixme: Go back to 512 bytes once https:/..." (godox)
internal/helper/exception/exception.go:11:14: SA1019: "gitlab.com/gitlab-org/labkit/correlation/raven" is deprecated: Use gitlab.com/gitlab-org/labkit/errortracking instead. (staticcheck)
internal/helper/exception/exception.go:36:11: SA1019: correlation.SetExtra is deprecated: Use gitlab.com/gitlab-org/labkit/errortracking instead. (staticcheck)
internal/httprs/httprs_test.go:13:2: dot-imports: should not use dot imports (revive)
internal/imageresizer/image_resizer.go:1:1: package-comments: should have a package comment (revive)
internal/imageresizer/image_resizer.go:30:6: exported: exported type Resizer should have comment or be unexported (revive)
internal/imageresizer/image_resizer.go:141:1: exported: exported function NewResizer should have comment or be unexported (revive)
internal/imageresizer/image_resizer.go:149: Function 'Inject' is too long (65 > 60) (funlen)
internal/imageresizer/image_resizer.go:172:30: Error return value of `imageFile.reader.Close` is not checked (errcheck)
internal/imageresizer/image_resizer.go:195:32: Error return value of `command.KillProcessGroup` is not checked (errcheck)
internal/imageresizer/image_resizer.go:350:17: Error return value of `res.Body.Close` is not checked (errcheck)
internal/imageresizer/image_resizer.go:356:15: G304: Potential file inclusion via variable (gosec)
internal/imageresizer/image_resizer.go:363:13: Error return value of `file.Close` is not checked (errcheck)
internal/imageresizer/image_resizer_caching.go:6:1: ST1000: at least one file in a package should have a package comment (stylecheck)
internal/lsif_transformer/parser/docs.go:36:2: var-naming: struct field RangeIds should be RangeIDs (revive)
internal/lsif_transformer/parser/parser.go:90:1: exported: exported method Parser.Close should have comment or be unexported (revive)
internal/lsif_transformer/parser/ranges.go:35:2: var-naming: struct field RangeIds should be RangeIDs (revive)
internal/lsif_transformer/parser/ranges.go:98:41: var-naming: method parameter rangeIds should be rangeIDs (revive)
internal/proxy/proxy.go:142:14: SA6002: argument should be pointer-like to avoid allocations (staticcheck)
internal/redis/keywatcher.go:1:1: package-comments: should have a package comment (revive)
internal/redis/keywatcher.go:19:6: exported: exported type KeyWatcher should have comment or be unexported (revive)
internal/redis/keywatcher.go:28:1: exported: exported function NewKeyWatcher should have comment or be unexported (revive)
internal/redis/keywatcher.go:42:2: exported: exported var KeyWatchers should have comment or be unexported (revive)
internal/redis/keywatcher.go:90:16: Error return value of `kw.conn.Close` is not checked (errcheck)
internal/redis/keywatcher.go:120:66: unnecessary conversion (unconvert)
internal/redis/keywatcher.go:129:1: exported: exported method KeyWatcher.Process should have comment or be unexported (revive)
internal/redis/keywatcher.go:150:1: exported: exported method KeyWatcher.Shutdown should have comment or be unexported (revive)
internal/redis/keywatcher.go:232:23: Error return value of `kw.conn.Unsubscribe` is not checked (errcheck)
internal/redis/keywatcher.go:252:1: exported: exported method KeyWatcher.WatchKey should have comment or be unexported (revive)
internal/redis/keywatcher_test.go:120:38: unnecessary leading newline (whitespace)
internal/redis/redis.go:1:1: ST1000: at least one file in a package should have a package comment (stylecheck)
internal/redis/redis.go:18:2: blank-imports: a blank import should be only in a main or test package, or have a comment justifying it (revive)
internal/redis/redis.go:23:24: var-declaration: should omit type error from declaration of var errSentinelMasterAddr; it will be inferred from the right-hand side (revive)
internal/redis/redis.go:25:2: exported: exported var TotalConnections should have comment or be unexported (revive)
internal/redis/redis.go:110:10: elseif: can replace 'else {if cond {}}' with 'else if cond {}' (gocritic)
internal/redis/redis_test.go:24:2: error-nil: use require.NoError (testifylint)
internal/redis/redis_test.go:29:3: error-nil: use require.NoError (testifylint)
internal/redis/redis_test.go:79:15: `initialise` is a misspelling of `initialize` (misspell)
internal/redis/redis_test.go:119:15: `initialise` is a misspelling of `initialize` (misspell)
internal/senddata/contentprocessor/contentprocessor.go:136:35: response body must be closed (bodyclose)
internal/sendfile/sendfile_test.go:180:34: response body must be closed (bodyclose)
internal/sendurl/sendurl.go:106: Function 'Inject' has too many statements (51 > 40) (funlen)
internal/sendurl/sendurl.go:248:45: response body must be closed (bodyclose)
internal/testhelper/gitaly.go:277: 277-296 lines are duplicate of `internal/testhelper/gitaly.go:315-336` (dupl)
internal/testhelper/gitaly.go:315: 315-336 lines are duplicate of `internal/testhelper/gitaly.go:338-357` (dupl)
internal/testhelper/gitaly.go:338: 338-357 lines are duplicate of `internal/testhelper/gitaly.go:277-296` (dupl)
internal/testhelper/testhelper.go:18:2: import 'github.com/dlclark/regexp2' is not allowed from list 'main' (depguard)
internal/testhelper/testhelper.go:243:21: G302: Expect file permissions to be 0600 or less (gosec)
internal/transport/transport.go:133:1: cognitive complexity 38 of func `validateIPAddress` is high (> 20) (gocognit)
internal/upload/artifacts_upload_test.go:49:1: cognitive complexity 32 of func `testArtifactsUploadServer` is high (> 20) (gocognit)
internal/upload/artifacts_uploader.go:62: Function 'generateMetadataFromZip' is too long (66 > 60) (funlen)
internal/upload/artifacts_uploader.go:82:11: G204: Subprocess launched with a potential tainted input or cmd arguments (gosec)
internal/upload/destination/destination.go:72: internal/upload/destination/destination.go:72: Line contains TODO/BUG/FIXME/NOTE/OPTIMIZE/HACK: "TODO: remove `data` these once rails ful..." (godox)
internal/upload/destination/destination.go:117: Function 'Upload' has too many statements (48 > 40) (funlen)
internal/upload/destination/multi_hash.go:4:2: G501: Blocklisted import crypto/md5: weak cryptographic primitive (gosec)
internal/upload/destination/multi_hash.go:5:2: G505: Blocklisted import crypto/sha1: weak cryptographic primitive (gosec)
internal/upload/destination/objectstore/object_test.go:127:4: go-require: do not use assert.FailNow in http handlers (testifylint)
internal/upload/destination/objectstore/test/objectstore_stub.go:4:2: G501: Blocklisted import crypto/md5: weak cryptographic primitive (gosec)
internal/upload/destination/objectstore/test/objectstore_stub.go:169:13: G401: Use of weak cryptographic primitive (gosec)
internal/upload/destination/objectstore/upload_strategy.go:29: internal/upload/destination/objectstore/upload_strategy.go:29: Line contains TODO/BUG/FIXME/NOTE/OPTIMIZE/HACK: "TODO: consider adding the context to the..." (godox)
internal/upload/destination/objectstore/uploader.go:5:2: G501: Blocklisted import crypto/md5: weak cryptographic primitive (gosec)
internal/upload/destination/objectstore/uploader.go:95:12: G401: Use of weak cryptographic primitive (gosec)
internal/upload/exif/exif.go:103:10: G204: Subprocess launched with variable (gosec)
internal/upload/uploads.go:62:16: Error return value of `fmt.Fprintln` is not checked (errcheck)
internal/upload/uploads.go:101:15: Error return value of `fmt.Fprintln` is not checked (errcheck)
internal/upload/uploads_test.go:527:3: negative-positive: use assert.Positive (testifylint)
internal/upload/uploads_test.go:545:3: negative-positive: use assert.Positive (testifylint)
internal/upstream/routes.go:170:74: `(*upstream).wsRoute` - `matchers` always receives `nil` (unparam)
internal/upstream/routes.go:230: Function 'configureRoutes' is too long (333 > 60) (funlen)
internal/upstream/routes.go:479: internal/upstream/routes.go:479: Line contains TODO/BUG/FIXME/NOTE/OPTIMIZE/HACK: "TODO: We should probably not return a HT..." (godox)
internal/upstream/upstream.go:116: internal/upstream/upstream.go:116: Line contains TODO/BUG/FIXME/NOTE/OPTIMIZE/HACK: "TODO: move to LabKit https://gitlab.com/..." (godox)
internal/zipartifacts/open_archive.go:78:28: response body must be closed (bodyclose)
