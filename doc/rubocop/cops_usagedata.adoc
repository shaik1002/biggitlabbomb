////
  Do NOT edit this file by hand directly, as it is automatically generated.

  Please make any necessary changes to the cop documentation within the source files themselves.
////

= UsageData

[#usagedatadistinctcountbylargeforeignkey]
== UsageData/DistinctCountByLargeForeignKey

|===
| Enabled by default | Safe | Supports autocorrection | Version Added | Version Changed

| Enabled
| Yes
| No
| -
| -
|===

Allows counts only for selected tables' foreign keys for `distinct_count` method.

Because distinct_counts over large tables' foreign keys will take a long time

[#examples-usagedatadistinctcountbylargeforeignkey]
=== Examples

[source,ruby]
----
# bad because pipeline_id points to a large table
distinct_count(Ci::Build, :commit_id)
----

[#usagedatahistogramwithlargetable]
== UsageData/HistogramWithLargeTable

|===
| Enabled by default | Safe | Supports autocorrection | Version Added | Version Changed

| Enabled
| Yes
| No
| -
| -
|===

This cop checks that histogram method is not used in usage_data.rb files
for models representing large tables, as defined by migration helpers.

# bad
histogram(Issue, buckets: 1..100)
histogram(User.active, buckets: 1..100)

[#usagedatainstrumentationsuperclass]
== UsageData/InstrumentationSuperclass

|===
| Enabled by default | Safe | Supports autocorrection | Version Added | Version Changed

| Enabled
| Yes
| No
| -
| -
|===

This cop checks that metric instrumentation classes subclass one of the allowed base classes.

[#examples-usagedatainstrumentationsuperclass]
=== Examples

[source,ruby]
----
# good
class CountIssues < DatabaseMetric
  # ...
end

# bad
class CountIssues < BaseMetric
  # ...
end
----

[#usagedatalargetable]
== UsageData/LargeTable

|===
| Enabled by default | Safe | Supports autocorrection | Version Added | Version Changed

| Enabled
| Yes
| No
| -
| -
|===

No documentation
